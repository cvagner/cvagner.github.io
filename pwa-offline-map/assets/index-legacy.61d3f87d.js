!function(){function e(e,t,o,n,r,i,a){try{var l=e[i](a),c=l.value}catch(s){return void o(s)}l.done?t(c):Promise.resolve(c).then(n,r)}function t(t){return function(){var o=this,n=arguments;return new Promise((function(r,i){var a=t.apply(o,n);function l(t){e(a,r,i,l,c,"next",t)}function c(t){e(a,r,i,l,c,"throw",t)}l(void 0)}))}}var o=document.createElement("style");o.innerHTML='.ol-box{box-sizing:border-box;border-radius:2px;border:1.5px solid rgb(179,197,219);background-color:rgba(255,255,255,.4)}.ol-mouse-position{top:8px;right:8px;position:absolute}.ol-scale-line{background:rgba(0,60,136,.3);border-radius:4px;bottom:8px;left:8px;padding:2px;position:absolute}.ol-scale-line-inner{border:1px solid #eee;border-top:none;color:#eee;font-size:10px;text-align:center;margin:1px;will-change:contents,width;transition:all .25s}.ol-scale-bar{position:absolute;bottom:8px;left:8px}.ol-scale-step-marker{width:1px;height:15px;background-color:#000;float:right;z-index:10}.ol-scale-step-text{position:absolute;bottom:-5px;font-size:12px;z-index:11;color:#000;text-shadow:-2px 0 #FFFFFF,0 2px #FFFFFF,2px 0 #FFFFFF,0 -2px #FFFFFF}.ol-scale-text{position:absolute;font-size:14px;text-align:center;bottom:25px;color:#000;text-shadow:-2px 0 #FFFFFF,0 2px #FFFFFF,2px 0 #FFFFFF,0 -2px #FFFFFF}.ol-scale-singlebar{position:relative;height:10px;z-index:9;box-sizing:border-box;border:1px solid black}.ol-unsupported{display:none}.ol-viewport,.ol-unselectable{-webkit-touch-callout:none;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;-webkit-tap-highlight-color:rgba(0,0,0,0)}.ol-viewport canvas{all:unset}.ol-selectable{-webkit-touch-callout:default;-webkit-user-select:text;-moz-user-select:text;-ms-user-select:text;user-select:text}.ol-grabbing{cursor:-webkit-grabbing;cursor:-moz-grabbing;cursor:grabbing}.ol-grab{cursor:move;cursor:-webkit-grab;cursor:-moz-grab;cursor:grab}.ol-control{position:absolute;background-color:rgba(255,255,255,.4);border-radius:4px;padding:2px}.ol-control:hover{background-color:rgba(255,255,255,.6)}.ol-zoom{top:.5em;left:.5em}.ol-rotate{top:.5em;right:.5em;transition:opacity .25s linear,visibility 0s linear}.ol-rotate.ol-hidden{opacity:0;visibility:hidden;transition:opacity .25s linear,visibility 0s linear .25s}.ol-zoom-extent{top:4.643em;left:.5em}.ol-full-screen{right:.5em;top:.5em}.ol-control button{display:block;margin:1px;padding:0;color:#fff;font-weight:700;text-decoration:none;font-size:inherit;text-align:center;height:1.375em;width:1.375em;line-height:.4em;background-color:rgba(0,60,136,.5);border:none;border-radius:2px}.ol-control button::-moz-focus-inner{border:none;padding:0}.ol-zoom-extent button{line-height:1.4em}.ol-compass{display:block;font-weight:400;font-size:1.2em;will-change:transform}.ol-touch .ol-control button{font-size:1.5em}.ol-touch .ol-zoom-extent{top:5.5em}.ol-control button:hover,.ol-control button:focus{text-decoration:none;background-color:rgba(0,60,136,.7)}.ol-zoom .ol-zoom-in{border-radius:2px 2px 0 0}.ol-zoom .ol-zoom-out{border-radius:0 0 2px 2px}.ol-attribution{text-align:right;bottom:.5em;right:.5em;max-width:calc(100% - 1.3em);display:flex;flex-flow:row-reverse;align-items:center}.ol-attribution a{color:rgba(0,60,136,.7);text-decoration:none}.ol-attribution ul{margin:0;padding:1px .5em;color:#000;text-shadow:0 0 2px #fff;font-size:12px}.ol-attribution li{display:inline;list-style:none}.ol-attribution li:not(:last-child):after{content:" "}.ol-attribution img{max-height:2em;max-width:inherit;vertical-align:middle}.ol-attribution button{flex-shrink:0}.ol-attribution.ol-collapsed ul{display:none}.ol-attribution:not(.ol-collapsed){background:rgba(255,255,255,.8)}.ol-attribution.ol-uncollapsible{bottom:0;right:0;border-radius:4px 0 0}.ol-attribution.ol-uncollapsible img{margin-top:-.2em;max-height:1.6em}.ol-attribution.ol-uncollapsible button{display:none}.ol-zoomslider{top:4.5em;left:.5em;height:200px}.ol-zoomslider button{position:relative;height:10px}.ol-touch .ol-zoomslider{top:5.5em}.ol-overviewmap{left:.5em;bottom:.5em}.ol-overviewmap.ol-uncollapsible{bottom:0;left:0;border-radius:0 4px 0 0}.ol-overviewmap .ol-overviewmap-map,.ol-overviewmap button{display:block}.ol-overviewmap .ol-overviewmap-map{border:1px solid #7b98bc;height:150px;margin:2px;width:150px}.ol-overviewmap:not(.ol-collapsed) button{bottom:2px;left:2px;position:absolute}.ol-overviewmap.ol-collapsed .ol-overviewmap-map,.ol-overviewmap.ol-uncollapsible button{display:none}.ol-overviewmap:not(.ol-collapsed){background:rgba(255,255,255,.8)}.ol-overviewmap-box{border:2px dotted rgba(0,60,136,.7)}.ol-overviewmap .ol-overviewmap-box:hover{cursor:move}body{font-family:Avenir,Helvetica,Arial,sans-serif;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale;text-align:center;color:#2c3e50}h1{font-size:1.5em;margin-block:.3em}.map{width:100%;height:400px}.toolbar{margin-bottom:10px}.toolbar button{margin-top:4px;line-height:2em}\n',document.head.appendChild(o),System.register(["./vendor-legacy.d277dec9.js"],(function(){"use strict";var e,o,n,r,i,a,l,c,s,u,p,d,m,g,b,h,f,x,v;return{setters:[function(t){e=t.v,o=t.n,n=t.G,r=t.F,i=t.S,a=t.C,l=t.a,c=t.b,s=t.P,u=t.V,p=t.c,d=t.M,m=t.d,g=t.f,b=t.g,h=t.e,f=t.W,x=t.h,v=t.T}],execute:function(){function w(){return(w=t(regeneratorRuntime.mark((function e(t,o){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:caches.match(o,{cacheName:"orthophotos"}).then((function(e){null!=e&&e.blob?e.blob().then((function(e){var o=URL.createObjectURL(e);t.getImage().onload=function(){return URL.revokeObjectURL(o)},t.getImage().src=o})):t.getImage().src=o}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var y,F,k,z,R=100;function I(){return(I=t(regeneratorRuntime.mark((function e(t){var o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=1*Math.ceil(t.length/R),e.abrupt("return",o);case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function E(){return(E=t(regeneratorRuntime.mark((function e(t){var o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!((o=t.splice(0,R)).length<=0)){e.next=4;break}return e.abrupt("break",9);case 4:return L(o),e.next=7,T(1e3);case 7:e.next=0;break;case 9:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function L(e){return G.apply(this,arguments)}function G(){return(G=t(regeneratorRuntime.mark((function e(t){var o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,window.caches.open("orthophotos");case 2:return o=e.sent,e.next=5,o.addAll(t);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function T(e){return new Promise((function(t){return setTimeout(t,e)}))}function P(e){y.setTracking(e)}var S=function(){var n,r,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},a=i.immediate,l=void 0!==a&&a,c=i.onNeedRefresh,s=i.onOfflineReady,u=i.onRegistered,p=i.onRegisterError,d=function(){var e=t(regeneratorRuntime.mark((function e(){var t=arguments;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((!(t.length>0&&void 0!==t[0])||t[0])&&(null==n||n.addEventListener("controlling",(function(e){e.isUpdate&&window.location.reload()}))),!r||!r.waiting){e.next=5;break}return e.next=5,o(r.waiting,{type:"SKIP_WAITING"});case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();if("serviceWorker"in navigator){(n=new e("./sw.js",{scope:"./",type:"classic"})).addEventListener("activated",(function(e){e.isUpdate||null==s||s()}));var m=function(){null==c||c()};n.addEventListener("waiting",m),n.addEventListener("externalwaiting",m),n.register({immediate:l}).then((function(e){r=e,null==u||u(e)})).catch((function(e){null==p||p(e)}))}return d}({onNeedRefresh:function(){confirm("Une version plus r√©cente de l'application est disponible. Recharger ?")&&S()},onOfflineReady:function(){alert("L'application est pr√™te √† fonctionner sans r√©seau.")}});document.querySelector("#app").innerHTML='\n  <h1>Photographies a√©riennes <span id="status"></span></h1>\n  <div class="toolbar">\n    <button id="load-cache" title="du niveau de zoom courant au plus grand">‚òÖ Conserver l\'√©tendue</button>\n    <button id="clear-cache">‚òÜ Vider le cache</button>\n    <button id="goto-dijon">‚ù± Dijon</button>\n\n    <button id="position"><span id="positionIcon">‚úï</span> Suivre position</button>\n    <button id="center-position">‚Ä¢ Centrer</button>\n  </div>\n  <div id="map" class="map"></div>\n',document.getElementById("load-cache").onclick=function(){var e=V.getView().calculateExtent(V.getSize()),t=V.getView().getZoom();if(t<15)alert("Un nombre trop important de tuiles serait mis en cache √† cette √©chelle. Veuillez zoomer");else{var o=function(e,t,o){for(var n=[],r=o.getTileGrid().getMaxZoom(),i=Math.floor(t);i<=r;i++)o.getTileGrid().forEachTileCoord(e,parseInt(i),(function(e){return n.push(o.getTileUrlFunction()(e))}));return n}(e,t,Z);o.length>200&&!confirm(o.length+" tuiles seront mises en cache ("+function(e){return I.apply(this,arguments)}(o)+" sec avec la fibre environ). Continuer ?")||function(e){E.apply(this,arguments)}(o)}},document.getElementById("clear-cache").onclick=function(){caches.delete("orthophotos")},document.getElementById("goto-dijon").onclick=function(){V.getView().fit([561156.3584244443,5998685.964885023,561713.7014265041,5998807.655496827])};var j=!1,O=document.getElementById("positionIcon");function M(){var e=document.getElementById("status");e&&(e.innerText=navigator.onLine?"‚ö°":"üí§")}document.getElementById("position").onclick=function(){P(j=!j),O.innerText=j?"‚úì":"‚úï"},document.getElementById("center-position").onclick=function e(){var t=y.getPosition();if(t){z.getView().setCenter(t);var o=z.getView().getZoom();z.getView().setZoom(Math.max(o,16))}else y.once("change:position",(function(){return e()})),P(!0)},window.addEventListener("online",M),window.addEventListener("offline",M),M();for(var V=new d({target:"map",view:new m({zoom:5,center:g([5,45])})}),C=[],U=[],A=b("EPSG:3857"),B=h(A.getExtent())/256,H=0;H<20;H++)U[H]=H.toString(),C[H]=B/Math.pow(2,H);var N=new f({origin:[-20037508,20037508],resolutions:C,matrixIds:U}),Z=new x({url:"https://wxs.ign.fr/essentiels/geoportail/wmts",layer:"ORTHOIMAGERY.ORTHOPHOTOS",matrixSet:"PM",format:"image/jpeg",projection:"EPSG:3857",tileGrid:N,style:"normal",attributions:'<a href="https://www.ign.fr/" target="_blank"><img src="https://wxs.ign.fr/static/logos/IGN/IGN.gif" title="Institut national de l\'information g√©ographique et foresti√®re" alt="IGN"></a>',tileLoadFunction:function(e,t){return w.apply(this,arguments)}});V.addLayer(new v({source:Z})),(y=new n({trackingOptions:{enableHighAccuracy:!0},projection:(z=V).getView().getProjection()})).on("error",(function(e){return console.log(e.message)})),F=new r,y.on("change:accuracyGeometry",(function(){F.setGeometry(y.getAccuracyGeometry())})),(k=new r).setStyle(new i({image:new a({radius:6,fill:new l({color:"#3399CC"}),stroke:new c({color:"#fff",width:2})})})),y.on("change:position",(function(){var e=y.getPosition();k.setGeometry(e?new s(e):null)})),new u({map:z,source:new p({features:[F,k]})})}}}))}();
